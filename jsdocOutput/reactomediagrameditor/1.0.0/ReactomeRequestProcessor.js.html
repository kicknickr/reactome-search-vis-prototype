<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>ReactomeRequestProcessor.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="AdvancedSearchPresComponent.html">AdvancedSearchPresComponent</a><ul class='methods'><li data-type='method'><a href="AdvancedSearchPresComponent.html#getQueryParams">getQueryParams</a></li><li data-type='method'><a href="AdvancedSearchPresComponent.html#renderCollapsibleSectionsComp">renderCollapsibleSectionsComp</a></li><li data-type='method'><a href="AdvancedSearchPresComponent.html#renderRelationalSearchChooserComp">renderRelationalSearchChooserComp</a></li><li data-type='method'><a href="AdvancedSearchPresComponent.html#switchTab">switchTab</a></li></ul></li><li><a href="BaseSearchComponent.html">BaseSearchComponent</a><ul class='methods'><li data-type='method'><a href="BaseSearchComponent.html#destroy">destroy</a></li><li data-type='method'><a href="BaseSearchComponent.html#gatherQueryParameters">gatherQueryParameters</a></li><li data-type='method'><a href="BaseSearchComponent.html#getConstrainedRelationLiveResults">getConstrainedRelationLiveResults</a></li><li data-type='method'><a href="BaseSearchComponent.html#getPreliminaryLiveResults">getPreliminaryLiveResults</a></li><li data-type='method'><a href="BaseSearchComponent.html#handlePreliminaryResult">handlePreliminaryResult</a></li><li data-type='method'><a href="BaseSearchComponent.html#handlePreliminaryResults">handlePreliminaryResults</a></li><li data-type='method'><a href="BaseSearchComponent.html#makeQueryRequest">makeQueryRequest</a></li><li data-type='method'><a href="BaseSearchComponent.html#queryResult2liveResForm">queryResult2liveResForm</a></li><li data-type='method'><a href="BaseSearchComponent.html#updateQueryResults">updateQueryResults</a></li><li data-type='method'><a href="BaseSearchComponent.html#validateQueryParams">validateQueryParams</a></li></ul></li><li><a href="CollapsibleSectionsComp.html">CollapsibleSectionsComp</a></li><li><a href="CustomMDCChipSetComp.html">CustomMDCChipSetComp</a><ul class='methods'><li data-type='method'><a href="CustomMDCChipSetComp.html#getSelectedValues">getSelectedValues</a></li><li data-type='method'><a href="CustomMDCChipSetComp.html#setAllChipsSelected">setAllChipsSelected</a></li><li data-type='method'><a href="CustomMDCChipSetComp.html#toggleUserInteractionAllowed">toggleUserInteractionAllowed</a></li></ul></li><li><a href="DiagramEditorPage.html">DiagramEditorPage</a></li><li><a href="DiagramEditorStateManager.html">DiagramEditorStateManager</a><ul class='methods'><li data-type='method'><a href="DiagramEditorStateManager.html#generateNodeForPE">generateNodeForPE</a></li><li data-type='method'><a href="DiagramEditorStateManager.html#generateNodesForEntirePathwayImport">generateNodesForEntirePathwayImport</a></li></ul></li><li><a href="DiagramEditorViewport.html">DiagramEditorViewport</a><ul class='methods'><li data-type='method'><a href="DiagramEditorViewport.html#initCanvasForPathwayImport">initCanvasForPathwayImport</a></li></ul></li><li><a href="ISearchPresManager.html">ISearchPresManager</a><ul class='methods'><li data-type='method'><a href="ISearchPresManager.html#addResultToDisplay">addResultToDisplay</a></li><li data-type='method'><a href="ISearchPresManager.html#clearResultsDisplay">clearResultsDisplay</a></li><li data-type='method'><a href="ISearchPresManager.html#destroy">destroy</a></li><li data-type='method'><a href="ISearchPresManager.html#getAllUserQueryParams">getAllUserQueryParams</a></li><li data-type='method'><a href="ISearchPresManager.html#openDisplay">openDisplay</a></li><li data-type='method'><a href="ISearchPresManager.html#toggleAllQueryInput">toggleAllQueryInput</a></li></ul></li><li><a href="module-RenderableNode.html">RenderableNode</a></li><li><a href="NonPresentingEntitiesWithinComplexSearchComp.html">NonPresentingEntitiesWithinComplexSearchComp</a><ul class='methods'><li data-type='method'><a href="NonPresentingEntitiesWithinComplexSearchComp.html#destroy">destroy</a></li><li data-type='method'><a href="NonPresentingEntitiesWithinComplexSearchComp.html#gatherQueryParameters">gatherQueryParameters</a></li><li data-type='method'><a href="NonPresentingEntitiesWithinComplexSearchComp.html#getConstrainedRelationLiveResults">getConstrainedRelationLiveResults</a></li><li data-type='method'><a href="NonPresentingEntitiesWithinComplexSearchComp.html#getPreliminaryLiveResults">getPreliminaryLiveResults</a></li><li data-type='method'><a href="NonPresentingEntitiesWithinComplexSearchComp.html#handlePreliminaryResult">handlePreliminaryResult</a></li><li data-type='method'><a href="NonPresentingEntitiesWithinComplexSearchComp.html#handlePreliminaryResults">handlePreliminaryResults</a></li><li data-type='method'><a href="NonPresentingEntitiesWithinComplexSearchComp.html#makeQueryRequest">makeQueryRequest</a></li><li data-type='method'><a href="NonPresentingEntitiesWithinComplexSearchComp.html#queryResult2liveResForm">queryResult2liveResForm</a></li><li data-type='method'><a href="NonPresentingEntitiesWithinComplexSearchComp.html#updateQueryResults">updateQueryResults</a></li><li data-type='method'><a href="NonPresentingEntitiesWithinComplexSearchComp.html#validateQueryParams">validateQueryParams</a></li></ul></li><li><a href="NonPresentingPathwaysContainingEntrySearchComp.html">NonPresentingPathwaysContainingEntrySearchComp</a><ul class='methods'><li data-type='method'><a href="NonPresentingPathwaysContainingEntrySearchComp.html#destroy">destroy</a></li><li data-type='method'><a href="NonPresentingPathwaysContainingEntrySearchComp.html#gatherQueryParameters">gatherQueryParameters</a></li><li data-type='method'><a href="NonPresentingPathwaysContainingEntrySearchComp.html#getConstrainedRelationLiveResults">getConstrainedRelationLiveResults</a></li><li data-type='method'><a href="NonPresentingPathwaysContainingEntrySearchComp.html#getPreliminaryLiveResults">getPreliminaryLiveResults</a></li><li data-type='method'><a href="NonPresentingPathwaysContainingEntrySearchComp.html#handlePreliminaryResult">handlePreliminaryResult</a></li><li data-type='method'><a href="NonPresentingPathwaysContainingEntrySearchComp.html#handlePreliminaryResults">handlePreliminaryResults</a></li><li data-type='method'><a href="NonPresentingPathwaysContainingEntrySearchComp.html#makeQueryRequest">makeQueryRequest</a></li><li data-type='method'><a href="NonPresentingPathwaysContainingEntrySearchComp.html#queryResult2liveResForm">queryResult2liveResForm</a></li><li data-type='method'><a href="NonPresentingPathwaysContainingEntrySearchComp.html#updateQueryResults">updateQueryResults</a></li><li data-type='method'><a href="NonPresentingPathwaysContainingEntrySearchComp.html#validateQueryParams">validateQueryParams</a></li></ul></li><li><a href="PageSwitcher.html">PageSwitcher</a><ul class='methods'><li data-type='method'><a href="PageSwitcher.html#switchPage">switchPage</a></li></ul></li><li><a href="PaneComponent.html">PaneComponent</a><ul class='methods'><li data-type='method'><a href="PaneComponent.html#addActionButton">addActionButton</a></li><li data-type='method'><a href="PaneComponent.html#close">close</a></li><li data-type='method'><a href="PaneComponent.html#destroy">destroy</a></li><li data-type='method'><a href="PaneComponent.html#getAllowDragging">getAllowDragging</a></li><li data-type='method'><a href="PaneComponent.html#getPaneBodySel">getPaneBodySel</a></li><li data-type='method'><a href="PaneComponent.html#open">open</a></li><li data-type='method'><a href="PaneComponent.html#setAllowDragging">setAllowDragging</a></li></ul></li><li><a href="PresentingQueryBasedSearchComp.html">PresentingQueryBasedSearchComp</a><ul class='methods'><li data-type='method'><a href="PresentingQueryBasedSearchComp.html#.getReactomeFacetOptions">getReactomeFacetOptions</a></li><li data-type='method'><a href="PresentingQueryBasedSearchComp.html#destroy">destroy</a></li><li data-type='method'><a href="PresentingQueryBasedSearchComp.html#gatherQueryParameters">gatherQueryParameters</a></li><li data-type='method'><a href="PresentingQueryBasedSearchComp.html#getConstrainedRelationLiveResults">getConstrainedRelationLiveResults</a></li><li data-type='method'><a href="PresentingQueryBasedSearchComp.html#getPreliminaryLiveResults">getPreliminaryLiveResults</a></li><li data-type='method'><a href="PresentingQueryBasedSearchComp.html#handlePreliminaryResult">handlePreliminaryResult</a></li><li data-type='method'><a href="PresentingQueryBasedSearchComp.html#handlePreliminaryResults">handlePreliminaryResults</a></li><li data-type='method'><a href="PresentingQueryBasedSearchComp.html#makeQueryRequest">makeQueryRequest</a></li><li data-type='method'><a href="PresentingQueryBasedSearchComp.html#queryResult2liveResForm">queryResult2liveResForm</a></li><li data-type='method'><a href="PresentingQueryBasedSearchComp.html#setResultsConstraint">setResultsConstraint</a></li><li data-type='method'><a href="PresentingQueryBasedSearchComp.html#updateQueryResults">updateQueryResults</a></li><li data-type='method'><a href="PresentingQueryBasedSearchComp.html#validateQueryParams">validateQueryParams</a></li></ul></li><li><a href="QueryBasedSearchPresManager.html">QueryBasedSearchPresManager</a><ul class='methods'><li data-type='method'><a href="QueryBasedSearchPresManager.html#addResultToDisplay">addResultToDisplay</a></li><li data-type='method'><a href="QueryBasedSearchPresManager.html#clearResultsDisplay">clearResultsDisplay</a></li><li data-type='method'><a href="QueryBasedSearchPresManager.html#destroy">destroy</a></li><li data-type='method'><a href="QueryBasedSearchPresManager.html#getAllUserQueryParams">getAllUserQueryParams</a></li><li data-type='method'><a href="QueryBasedSearchPresManager.html#openDisplay">openDisplay</a></li><li data-type='method'><a href="QueryBasedSearchPresManager.html#toggleAllQueryInput">toggleAllQueryInput</a></li></ul></li><li><a href="ReactomeAPIQuerier.html">ReactomeAPIQuerier</a><ul class='methods'><li data-type='method'><a href="ReactomeAPIQuerier.html#.getDBEntryInfoRegular">getDBEntryInfoRegular</a></li><li data-type='method'><a href="ReactomeAPIQuerier.html#.getEntitiesWithinComplex">getEntitiesWithinComplex</a></li><li data-type='method'><a href="ReactomeAPIQuerier.html#.getEntrySearchResults">getEntrySearchResults</a></li><li data-type='method'><a href="ReactomeAPIQuerier.html#.getFacetTypes">getFacetTypes</a></li><li data-type='method'><a href="ReactomeAPIQuerier.html#.getLLDPathwaysContainingEntry">getLLDPathwaysContainingEntry</a></li><li data-type='method'><a href="ReactomeAPIQuerier.html#.getPathwayDiagramLayout">getPathwayDiagramLayout</a></li><li data-type='method'><a href="ReactomeAPIQuerier.html#.getPathwaysHavingDiagContainingEntry">getPathwaysHavingDiagContainingEntry</a></li></ul></li><li><a href="ReactomeRequestProcessor.html">ReactomeRequestProcessor</a><ul class='methods'><li data-type='method'><a href="ReactomeRequestProcessor.html#.getEntitiesWithinComplex">getEntitiesWithinComplex</a></li><li data-type='method'><a href="ReactomeRequestProcessor.html#.getEntrySearchResults">getEntrySearchResults</a></li><li data-type='method'><a href="ReactomeRequestProcessor.html#.getEntrySearchResultsFormatted">getEntrySearchResultsFormatted</a></li><li data-type='method'><a href="ReactomeRequestProcessor.html#.getHumanPathwayList">getHumanPathwayList</a></li><li data-type='method'><a href="ReactomeRequestProcessor.html#.getMapFacet2Types">getMapFacet2Types</a></li><li data-type='method'><a href="ReactomeRequestProcessor.html#.getPathwayDiagramLayout">getPathwayDiagramLayout</a></li><li data-type='method'><a href="ReactomeRequestProcessor.html#.getPathwaysHavingDiagContainingEntry">getPathwaysHavingDiagContainingEntry</a></li><li data-type='method'><a href="ReactomeRequestProcessor.html#getSampleDiagObj">getSampleDiagObj</a></li><li data-type='method'><a href="ReactomeRequestProcessor.html#rawPathwayLayout2diagObjs">rawPathwayLayout2diagObjs</a></li><li data-type='method'><a href="ReactomeRequestProcessor.html#searchForLLPathway">searchForLLPathway</a></li></ul></li><li><a href="SimpleSearchPresComponent.html">SimpleSearchPresComponent</a><ul class='methods'><li data-type='method'><a href="SimpleSearchPresComponent.html#toggleAllowUserSearchBarInput">toggleAllowUserSearchBarInput</a></li></ul></li><li><a href="TabBarComponent.html">TabBarComponent</a></li></ul><h3>Modules</h3><ul><li><a href="module-RenderableChemicalNode.html">RenderableChemicalNode</a></li><li><a href="module-RenderableComplexNode.html">RenderableComplexNode</a></li><li></li><li><a href="module-RenderableEntityNode.html">RenderableEntityNode</a></li><li><a href="module-RenderableEntitySetNode.html">RenderableEntitySetNode</a></li><li><a href="module-RenderableGeneNode.html">RenderableGeneNode</a></li><li><a href="module-RenderableNode.html">RenderableNode</a></li><li><a href="module-RenderableProcessNodeNode.html">RenderableProcessNodeNode</a></li><li></li><li><a href="module-RenderableRNANode.html">RenderableRNANode</a></li></ul><h3>Global</h3><ul><li><a href="global.html#advancedPaneTabTypes">advancedPaneTabTypes</a></li><li><a href="global.html#getTypeFacetOptionsForSearch">getTypeFacetOptionsForSearch</a></li><li><a href="global.html#resultsConstraintModeTypes">resultsConstraintModeTypes</a></li><li><a href="global.html#setup">setup</a></li><li><a href="global.html#subSearchTypes">subSearchTypes</a></li><li><a href="global.html#toggleSectionExpansion">toggleSectionExpansion</a></li><li><a href="global.html#validRelationSubSearchTypes">validRelationSubSearchTypes</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">ReactomeRequestProcessor.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import Fuse from "fuse.js";

import ReactomeAPIQuerier from "./ReactomeAPIQuerier";
import RenderableNode from "./RenderableNode";

// /** @typedef {module:ReactomeAPIQuerier.rawPathwayLayout_} rawPathwayLayout_ */
// /** @typedef {module:ReactomeAPIQuerier.compartment_} compartment_ */
// /** @typedef {module:ReactomeAPIQuerier.edge_} edge_ */
// /** @typedef {module:ReactomeAPIQuerier.node_} node_ */
// /** @typedef {module:RenderableNode.RenderableNode} RenderableNode */

/** TODO
 *
 * @typedef Pathway
 *
 * @property {string} stId -
 * @property {string} name -
 * @property {boolean} diagram -
 * @property {string} type -
 * @property {string} species -
 */

/** @typedef diagObjImport_
 * An object representing all relevant data from any diagram object imported from
 * {@link ReactomeRequestProcessor.getPathwayDiagramLayout}.
 * It represents the diagram object in the imported diagram
 * and not necessarily the entry in the DB it corresponds to (if it even has one).
 * It sufficiently represents physical entities but reaction-like-events and misc links are subclass-typed.
 * @property {number} rawDiagramID - ID of the diagram object in the original LL pathway diagram it was imported from
 * @property {?string} displayName - Display name of the object in the imported diagram
 * @property {?number} reactomeId - Reactome dbID of the object's entry
 * @property {?string} rawSchemaClass - Object's entry's type according to the reactomeKB schema
 * {@link https://reactome.org/content/schema/} TODO enumerate
 * @property {string} rawRenderableClass - Object's value for the class that determines
 * how an object should be rendered in the imported diagram TODO enumerate
 * @property {number} initialX - General location of the object, or its center, within the imported diagram -- X Val
 * @property {number} initialY - General location of the object, or its center, within the imported diagram -- Y Val
 */

/** @typedef {diagObjImport_} diagRLEImport_
 * A {@link diagObjImport_} for reaction-like-events
 * @property {string} reactionType -
 * @property {Array&lt;{id: number}>} activators -
 * @property {Array&lt;{id: number}>} catalysts -
 * @property {Array&lt;{id: number}>} inputs -
 * @property {Array&lt;{id: number}>} outputs -
 */

/** @typedef {diagObjImport_} diagMiscLinkObjImport_
 * A {@link diagObjImport_} for links between PEs that are not RLEs
 * @property {Array&lt;{id: number}>} inputs -
 * @property {Array&lt;{id: number}>} outputs -
 */

/**
 * Processes requests for information about the Reactome knowledge base.
 * Leverages the Reactome API ( see {@link ReactomeAPIQuerier} ).
 * Performs data transformations so that way UI logic can access data in a more convenient format.
 * Creates internal data-structures and lookup tables to speed-up subsequent/related requests.
 *
 // * @property {ReactomeAPIQuerier} reactomeAPIQuerier -
 // * The instance of the ReactomeAPIQuerier (see {@link ReactomeAPIQuerier})
 // * It is the only source of information about the Reactome knowledge base.

 * @property {Fuse} pathwayFuzzySearcher - A Fuse fuzzy search instance for all human pathways
 * @property {Set&lt;string>} renderableClassEncounteredValueSet
 * &lt;p> For debugging purposes
 * &lt;br> The set of values that have been so far encountered in the "renderableClass" field of all objects returned by
 * all queries returned from {@link DiagramEditorStateManager#reactomeRequestProcessor.getPathwayDiagramLayout}
 * @property {{nodes: Set&lt;string>, edges: Set&lt;string>, links: Set&lt;string>}} renderableClassEncounteredValueSetsGrouped
 * &lt;p> For debugging purposes
 * &lt;br> The set of values that have been so far encountered in the "renderableClass" field of the entries
 * (grouped by node, edge, and link) returned by all queries returned from
 * {@link DiagramEditorStateManager#reactomeRequestProcessor.getPathwayDiagramLayout}
 * @property {Set&lt;string>} schemaClassEncounteredValueSet
 * &lt;p> For debugging purposes
 * &lt;br> The set of values that have been so far encountered in the "schemaClass" field of all objects returned by
 * all queries returned from {@link DiagramEditorStateManager#reactomeRequestProcessor.getPathwayDiagramLayout}
 * @property {{nodes: Set&lt;string>, edges: Set&lt;string>, links: Set&lt;string>}} schemaClassEncounteredValueSetsGrouped
 * &lt;p> For debugging purposes
 * &lt;br> The set of values that have been so far encountered in the "schemaClass" field of the entries
 * (grouped by node, edge, and link) returned by all queries returned from
 * {@link DiagramEditorStateManager#reactomeRequestProcessor.getPathwayDiagramLayout}
 */
class ReactomeRequestProcessor {
    pathwayFuzzySearcher;
    renderableClassEncounteredValueSet;
    renderableClassEncounteredValueSetsGrouped;
    schemaClassEncounteredValueSet;
    schemaClassEncounteredValueSetsGrouped;

    constructor() {
        // this.reactomeAPIQuerier = new ReactomeAPIQuerier();
        //
        this.renderableClassEncounteredValueSetsGrouped = {nodes: new Set(), edges: new Set(), links: new Set()};
        this.schemaClassEncounteredValueSetsGrouped = {nodes: new Set(), edges: new Set(), links: new Set()};

        // this.setup();
        // this.test();
    }

    async test() {
        const res = await ReactomeRequestProcessor.getEntrySearchResults("DNA", new Set(), new Set(["Pathway"]), new Set(), new Set());
        console.log(res);
    }


    /**
     * @see {ReactomeAPIQuerier.getEntrySearchResults}
     *
     * @param {string} queryString - the query string
     * @param {Set&lt;string>} speciesSet - TODO
     * @param {Set&lt;string>} typeSet - a set of types of entries that the entry search will recognize TODO
     * @param {Set&lt;string>} compartmentSet - TODO
     * @param {Set&lt;string>} keywordSet - TODO
     * @returns {Promise&lt;{stId: string, name: string}>}
     */
    static async getEntrySearchResults(queryString, speciesSet, typeSet, compartmentSet, keywordSet) {
        return await ReactomeAPIQuerier.getEntrySearchResults(queryString, speciesSet, typeSet, compartmentSet, keywordSet);
    }

    /**
     * TODO
     *
     * @returns {Map&lt;string, Array&lt;{name: string, count: number}>>}
     */
    static async getMapFacet2Types() {
        const facetTypesResponse = await ReactomeAPIQuerier.getFacetTypes();

        return new Map(Object.entries(facetTypesResponse)
            .map(([key, value]) => {
                const facet = key.substring(0, key.indexOf("Facet"));
                if (facet) {
                    const validTypes = value["available"];
                    return [facet, validTypes];
                }
            })
            .filter((a) => a)
        );
    }

    /**
     * TODO DEsc
     *
     * @param {rawPathwayLayout_} pathwayLayoutRaw - See {@link ReactomeRequestProcessor.getPathwayDiagramLayout}
     * @returns {{PEs: Array&lt;diagObjImport_>, RLEs: Array&lt;diagRLEImport_>, miscLinkObjs: Array&lt;diagMiscLinkObjImport_>}}
     */
    rawPathwayLayout2diagObjs(pathwayLayoutRaw) {

        const PEs = pathwayLayoutRaw.nodes.map(PE => ({
            rawDiagramID: PE.id,
            displayName: PE.displayName,
            reactomeId: PE.reactomeId,
            rawSchemaClass: PE.schemaClass,
            rawRenderableClass: PE.renderableClass,
            initialX: PE.position.x,
            initialY: PE.position.y,
        }));

        const RLEs = pathwayLayoutRaw.edges.map(RLE => ({
            rawDiagramID: RLE.id,
            displayName: RLE.displayName,
            reactomeId: RLE.reactomeId,
            rawSchemaClass: RLE.schemaClass,
            rawRenderableClass: RLE.renderableClass,
            initialX: RLE.position.x,
            initialY: RLE.position.y,
            activators: RLE.activators,
            catalysts: RLE.catalysts,
            inhibitors: RLE.inhibitors,
            inputs: RLE.inputs,
            outputs: RLE.outputs,
            reactionType: RLE.reactionType
        }));

        const miscLinkObjs = pathwayLayoutRaw.links.map((link) => ({
            rawDiagramID: link.id,
            displayName: link.displayName,
            reactomeId: link.reactomeId,
            rawSchemaClass: link.schemaClass,
            rawRenderableClass: link.renderableClass,
            initialX: link.position.x,
            initialY: link.position.y,
            inputs: link.inputs,
            outputs: link.outputs,
        }));

        /* The following block updates some values maintained for debugging. See property docs */
        PEs.forEach((graphObject) => {
            this.renderableClassEncounteredValueSetsGrouped.nodes.add(graphObject.rawRenderableClass);
            this.schemaClassEncounteredValueSetsGrouped.nodes.add(graphObject.rawSchemaClass);
        });
        RLEs.forEach((graphObject) => {
            this.renderableClassEncounteredValueSetsGrouped.edges.add(graphObject.rawRenderableClass);
            this.schemaClassEncounteredValueSetsGrouped.edges.add(graphObject.rawSchemaClass);
        });
        miscLinkObjs.forEach((graphObject) => {
            this.renderableClassEncounteredValueSetsGrouped.links.add(graphObject.rawRenderableClass);
            this.schemaClassEncounteredValueSetsGrouped.links.add(graphObject.rawSchemaClass);
        });
        // console.log(this.renderableClassEncounteredValueSetsGrouped);
        // console.log(this.schemaClassEncounteredValueSetsGrouped);
        this.renderableClassEncounteredValueSet = (({nodes, edges, links}) =>
            new Set([...nodes, ...edges, ...links]))(this.renderableClassEncounteredValueSetsGrouped);
        this.schemaClassEncounteredValueSet = (({nodes, edges, links}) =>
            new Set([...nodes, ...edges, ...links]))(this.schemaClassEncounteredValueSetsGrouped);
        /* Block over */

        return {PEs, RLEs, miscLinkObjs};
    }

    // /**
    //  * Return the {@link rawPathwayLayout_} of the first LL pathway w/ diagram that contains the given entry
    //  *
    //  * @param {number} databaseEntryID - dbID of the entry
    //  * @returns {Promise&lt;rawPathwayLayout_>}
    //  */
    // static async OLDgetFirstPathwayForEntry(databaseEntryID) {
    //     const pathwayResultsWithEntry = await ReactomeAPIQuerier.getLLDPathwaysContainingEntry(databaseEntryID.toString());
    //     const firstPathwayResultDbId = pathwayResultsWithEntry[0].dbId;
    //     const pathwayLayoutRaw = await ReactomeAPIQuerier.getPathwayDiagramLayout(firstPathwayResultDbId);
    //     return pathwayLayoutRaw;
    // }

    /**
     * Return the first {@link diagObjImport_} corresponding to the desired entry
     * while transversing through LL pathways w/ diagram that contain the given entry
     *
     * @param {number} databaseEntryID - dbID of the entry
     * @returns {Promise&lt;rawPathwayLayout_>}
     */
    async getSampleDiagObj(databaseEntryID) {
        const pathwayResultsWithEntry = await ReactomeAPIQuerier.getLLDPathwaysContainingEntry(databaseEntryID.toString());
        const pathwayDbIds = pathwayResultsWithEntry.map((pathwayResult) => pathwayResult.dbId);
        for (const pathwayDbId of pathwayDbIds) {
            const rawPathwayLayout = await ReactomeAPIQuerier.getPathwayDiagramLayout(pathwayDbId);
            const {PEs, RLEs, miscLinkObjs} = await this.rawPathwayLayout2diagObjs(rawPathwayLayout);
            const targetDiagObjImportPE = [...PEs, ...RLEs, ...miscLinkObjs]
                .find((diagObjImport) => diagObjImport.reactomeId === databaseEntryID);
            if (targetDiagObjImportPE !== null) return targetDiagObjImportPE;
        }
    }

    /**
     * See {@link ReactomeAPIQuerier.getEntrySearchResults}
     * This formatted version only contains certain information TODO
     *
     * @returns {Array&lt;{dbId: number, stId: string, displayNameSearchHighlighted: string}>}
     */
    static async getEntrySearchResultsFormatted(queryString, entrySearchTypeSet) {
        const res = await ReactomeAPIQuerier.getEntrySearchResults(queryString, entrySearchTypeSet);
        //TODO
        if (res.results.length !== 1) throw Error("getEntrySearchResultsFormatted");
        return res.results[0].entries.map(({dbId, stId, name}) => ({
            dbId: parseInt(dbId),
            stId,
            displayNameSearchHighlighted: name
        }))
    }

    /** Search for Low-Level Pathways using the query string
     *
     * @param {string} query
     * @returns {Array&lt;Pathway>}
     */
    searchForLLPathway(query) {
        /** @type {Array&lt;Pathway>} */
        const results = this.pathwayFuzzySearcher.search(query);
        return results.filter((pathway) =>
            pathway.diagram &amp;&amp; pathway.type === "Pathway");
    }

    /**
     *
     * @returns {Promise&lt;Array&lt;Pathway>>}
     */
    static async getHumanPathwayList() {
        const trees = await ReactomeAPIQuerier.getHumanPathwayHierarchy();
        /** @type {Array&lt;Pathway>} */
        let pathwaysFlattened = [];
        const reduceTree = ((pathwayTree) => {
            const {children, ...pathway} = pathwayTree;
            pathwaysFlattened.push(pathway);
            if (children) {
                children.forEach(childTree => reduceTree(childTree));
            }
        });
        trees.forEach(topLevelTree => reduceTree(topLevelTree));

        return pathwaysFlattened;
    }

    /**
     *
     * @param {string} pathwayNameID
     * @returns {Promise&lt;rawPathwayLayout_>}
     */
    static async getPathwayDiagramLayout(pathwayNameID) {
        const pathwayLayoutRaw = await ReactomeAPIQuerier.getPathwayDiagramLayout(pathwayNameID);
        // const pathwayLayoutRaw = await ReactomeAPIQuerier.getPathwayDiagramInfo(pathwayNameID);
        return pathwayLayoutRaw;
    }

    /**
     * Query for pathways that contain the given dbEntryId
     *
     * @param {(number|string)} dbEntryId - TODO
     * @param {Set&lt;string>} speciesSet - The set of species to limit the search to
     * @param {boolean} onlyWithDiag - Whether to only include pathways with diagrams
     * @param {boolean} entryAllForms - Whether to include all forms of that entry
     * (can also be used if that entry is of an entity type ? TODO)
     * @returns {Promise&lt;{stId: string}>}
     */
    static async getPathwaysHavingDiagContainingEntry(dbEntryId, speciesSet, onlyWithDiag=true, entryAllForms=false) {
        // TODO call logic bools
        const test = await ReactomeAPIQuerier.getPathwaysHavingDiagContainingEntry(dbEntryId, speciesSet);
        // console.log(test);
        return test;
    }

    /**
     * @see {@link ReactomeAPIQuerier.getEntitiesWithinComplex}
     *
     * @param {(number|string)} dbEntryId
     * @param {boolean} excludeStructures
     * @returns {Promise&lt;{stId: string}>}
     */
    static async getEntitiesWithinComplex(dbEntryId, excludeStructures) {
        return await ReactomeAPIQuerier.getEntitiesWithinComplex(dbEntryId, excludeStructures);
    }
}

// const pathwayFuzzySearchOptions = {
//     shouldSort: true,
//     threshold: 0.5,
//     location: 0,
//     distance: 100,
//     maxPatternLength: 32,
//     minMatchCharLength: 1,
//     keys: [
//         "name",
//         "stId"
//     ]
// };

export default ReactomeRequestProcessor;</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.4</a> on Sun May 17 2020 02:35:00 GMT-0400 (Eastern Daylight Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
